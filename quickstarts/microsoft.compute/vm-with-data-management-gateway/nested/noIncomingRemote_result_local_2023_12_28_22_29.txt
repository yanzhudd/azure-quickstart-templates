arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "defaultValue": "zytest"}, "networkSecurityGroupName": {"type": "string", "defaultValue": "zytest"}, "publicIPAddressName": {"type": "string", "defaultValue": "zytest"}, "existingVnetLocation": {"type": "string", "defaultValue": "zytest"}}, "variables": {}, "resources": [{"apiVersion": "2016-03-30", "type": "Microsoft.Network/publicIPAddresses", "name": "[parameters(\'publicIPAddressName\')]", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"publicIPAllocationMethod": "Dynamic"}}, {"name": "[parameters(\'networkSecurityGroupName\')]", "type": "Microsoft.Network/networkSecurityGroups", "apiVersion": "2016-09-01", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"securityRules": [{"name": "default-allow-rdp", "properties": {"priority": 1000, "sourceAddressPrefix": "*", "protocol": "Tcp", "destinationPortRange": "3389", "access": "Allow", "direction": "Inbound", "sourcePortRange": "*", "destinationAddressPrefix": "*"}}]}}], "outputs": {"hostname": {"type": "string", "value": ""}}}


cli_script
```bash\n#!/bin/bash\n\n# Define template parameters as variables\nvmName="zytest"\nnetworkSecurityGroupName="zytest"\npublicIPAddressName="zytest"\nexistingVnetLocation="zytest"\n\n# Create a public IP address\naz network public-ip create \\\n    --name $publicIPAddressName \\\n    --location $existingVnetLocation \\\n    --allocation-method Dynamic \\\n    --tags vmname=$vmName\n\n# Create a network security group with a default rule to allow RDP access\naz network nsg create \\\n    --name $networkSecurityGroupName \\\n    --location $existingVnetLocation \\\n    --tags vmname=$vmName\n\n# Add a security rule to allow RDP\naz network nsg rule create \\\n    --nsg-name $networkSecurityGroupName \\\n    --name default-allow-rdp \\\n    --priority 1000 \\\n    --source-address-prefixes \'*\' \\\n    --destination-port-ranges 3389 \\\n    --access Allow \\\n    --direction Inbound \\\n    --protocol Tcp \\\n    --source-port-ranges \'*\' \\\n    --destination-address-prefixes \'*\'\n```


verify_result
