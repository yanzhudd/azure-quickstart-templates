arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "metadata": {"description": "Name of the Virtual Machine"}, "defaultValue": "zytest"}, "keyVaultResourceID": {"type": "string", "metadata": {"description": "KeyVault resource id. Ex: /subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus"}, "defaultValue": "zytest"}, "keyVaultSecretUrl": {"type": "string", "metadata": {"description": "KeyVault secret Url. Ex: https://diskencryptiontestaus.vault.azure.net/secrets/BitLockerEncryptionSecretWithKek/e088818e865e48488cf363af16dea596"}, "defaultValue": "zytest"}, "keyEncryptionKeyURL": {"type": "string", "defaultValue": "", "metadata": {"description": "KeyVault key encryption key Url. Ex: https://diskencryptiontestaus.vault.azure.net/keys/DiskEncryptionKek/562a4bb76b524a1493a6afe8e536ee78"}}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "resources": [{"apiVersion": "2016-04-30-preview", "type": "Microsoft.Compute/virtualMachines", "name": "[parameters(\'vmName\')]", "location": "[parameters(\'location\')]", "properties": {"storageProfile": {"osDisk": {"encryptionSettings": {"diskEncryptionKey": {"sourceVault": {"id": "[parameters(\'keyVaultResourceID\')]"}, "secretUrl": "[parameters(\'keyVaultSecretUrl\')]"}, "keyEncryptionKey": {"sourceVault": {"id": "[parameters(\'keyVaultResourceID\')]"}, "keyUrl": "[parameters(\'keyEncryptionKeyURL\')]"}}}}}}]}


cli_script
Below is the translated bash script from the provided ARM template and template parameters. Please note that I\'ve created variables for the parameters and translated the virtual machine resource into an Azure CLI command.\n\n```bash\n#!/bin/bash\n\n# Template parameters\nvmName="zytest"\nkeyVaultResourceID="/subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus"\nkeyVaultSecretUrl="https://diskencryptiontestaus.vault.azure.net/secrets/BitLockerEncryptionSecretWithKek/e088818e865e48488cf363af16dea596"\nkeyEncryptionKeyURL="https://diskencryptiontestaus.vault.azure.net/keys/DiskEncryptionKek/562a4bb76b524a1493a6afe8e536ee78"\nlocation="westus"\n\n# Create Virtual Machine with encryption settings\naz vm create \\\n  --name $vmName \\\n  --location $location \\\n  --encryption-at-host true \\\n  --disk-encryption-set $keyVaultResourceID \\\n  --keyvault $keyVaultResourceID \\\n  --admin-username \'your_admin_username\' \\\n  --admin-password \'your_admin_password\'\n\n# Encrypt OS disk\naz vm encryption enable \\\n  --resource-group \'your_resource_group\' \\\n  --name $vmName \\\n  --disk-encryption-keyvault $keyVaultResourceID \\\n  --key-encryption-key $keyEncryptionKeyURL \\\n  --volume-type OS\n\n# Note: Replace \'your_admin_username\', \'your_admin_password\', and \'your_resource_group\' with actual values.\n```\n\nPlease make sure to replace `\'your_admin_username\'`, `\'your_admin_password\'`, and `\'your_resource_group\'` with the actual values that you want to use for creating the virtual machine and enabling encryption.\n\nRemember to have the Azure CLI installed and logged in to your Azure account before running this script.


verify_result
