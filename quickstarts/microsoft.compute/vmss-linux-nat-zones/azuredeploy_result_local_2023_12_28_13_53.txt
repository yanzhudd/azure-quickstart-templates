arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"location": {"type": "string", "metadata": {"description": "Location for the VM, only certain regions support Availability Zones."}, "defaultValue": "westus"}, "adminUsername": {"type": "string", "metadata": {"description": "Admin username on all VMs"}, "defaultValue": "zytest"}, "ubuntuOSVersion": {"type": "string", "defaultValue": "16.04-LTS", "allowedValues": ["14.04.4-LTS", "16.04-LTS"], "metadata": {"description": "The Ubuntu version for the VM. This will pick a fully patched image of this given Ubuntu version. Allowed values are: 14.04.4-LTS, 16.04-LTS."}}, "vmssName": {"type": "string", "metadata": {"description": "String used as a base for naming resources. Must be 3-61 characters in length and globally unique across Azure. A hash is prepended to this string for some resources, and resource-specific information is appended."}, "maxLength": 61, "defaultValue": "zytest"}, "instanceCount": {"type": "int", "defaultValue": 3, "metadata": {"description": "Number of VM instances (100 or less)."}, "minValue": 3, "maxValue": 100}, "authenticationType": {"type": "string", "defaultValue": "sshPublicKey", "allowedValues": ["sshPublicKey", "password"], "metadata": {"description": "Type of authentication to use on the Virtual Machine. SSH key is recommended."}}, "adminPasswordOrKey": {"type": "securestring", "metadata": {"description": "SSH Key or password for the Virtual Machine. SSH key is recommended."}, "defaultValue": "zytest"}}, "variables": {"virtualNetworkName": "[concat(parameters(\'vmssName\'), \'vnet\')]", "publicIPAddressName": "lbPublicIp", "networkSecurityGroupName": "allowRemoting", "subnetName": "[concat(parameters(\'vmssName\'), \'subnet\')]", "loadBalancerName": "[concat(parameters(\'vmssName\'), \'lb\')]", "natPoolName": "[concat(parameters(\'vmssName\'), \'natpool\')]", "bePoolName": "[concat(parameters(\'vmssName\'), \'bepool\')]", "nicName": "[concat(parameters(\'vmssName\'), \'nic\')]", "ipConfigName": "[concat(parameters(\'vmssName\'), \'ipconfig\')]", "imageReference": {"publisher": "Canonical", "offer": "UbuntuServer", "sku": "[parameters(\'ubuntuOSVersion\')]", "version": "latest"}, "linuxConfiguration": {"disablePasswordAuthentication": true, "ssh": {"publicKeys": [{"path": "[concat(\'/home/\', parameters(\'adminUsername\'), \'/.ssh/authorized_keys\')]", "keyData": "[parameters(\'adminPasswordOrKey\')]"}]}}}, "resources": [{"type": "Microsoft.Network/virtualNetworks", "apiVersion": "2020-08-01", "name": "[variables(\'virtualNetworkName\')]", "location": "[parameters(\'location\')]", "properties": {"addressSpace": {"addressPrefixes": ["10.0.0.0/16"]}, "subnets": [{"name": "[variables(\'subnetName\')]", "properties": {"addressPrefix": "10.0.0.0/24"}}]}}, {"type": "Microsoft.Network/networkSecurityGroups", "apiVersion": "2017-10-01", "name": "[variables(\'networkSecurityGroupName\')]", "location": "[parameters(\'location\')]", "properties": {"securityRules": [{"name": "remoteConnection", "properties": {"description": "Allow RDP traffic", "protocol": "Tcp", "sourcePortRange": "*", "destinationPortRange": "22", "sourceAddressPrefix": "*", "destinationAddressPrefix": "*", "access": "Allow", "priority": 101, "direction": "Inbound"}}, {"name": "webTraffic", "properties": {"description": "Allow web traffic", "protocol": "Tcp", "sourcePortRange": "80", "destinationPortRange": "80", "sourceAddressPrefix": "*", "destinationAddressPrefix": "*", "access": "Allow", "priority": 100, "direction": "Inbound"}}]}}, {"type": "Microsoft.Network/publicIPAddresses", "apiVersion": "2017-10-01", "name": "[variables(\'publicIPAddressName\')]", "location": "[parameters(\'location\')]", "sku": {"name": "Standard"}, "properties": {"publicIPAllocationMethod": "Static", "dnsSettings": {"domainNameLabel": "[tolower(parameters(\'vmssName\'))]"}}}, {"type": "Microsoft.Network/loadBalancers", "apiVersion": "2017-10-01", "name": "[variables(\'loadBalancerName\')]", "location": "[parameters(\'location\')]", "sku": {"name": "Standard"}, "dependsOn": ["[resourceId(\'Microsoft.Network/publicIPAddresses\', variables(\'publicIPAddressName\'))]"], "properties": {"frontendIPConfigurations": [{"name": "LoadBalancerFrontEnd", "properties": {"publicIPAddress": {"id": "[resourceId(\'Microsoft.Network/publicIPAddresses\', variables(\'publicIPAddressName\'))]"}}}], "backendAddressPools": [{"name": "[variables(\'bePoolName\')]"}], "inboundNatPools": [{"name": "[variables(\'natPoolName\')]", "properties": {"frontendIPConfiguration": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/frontendIPConfigurations\', variables(\'loadBalancerName\'), \'loadBalancerFrontEnd\')]"}, "protocol": "Tcp", "frontendPortRangeStart": 50000, "frontendPortRangeEnd": 50099, "backendPort": 22}}]}}, {"type": "Microsoft.Compute/virtualMachineScaleSets", "name": "[parameters(\'vmssName\')]", "location": "[parameters(\'location\')]", "zones": ["1"], "apiVersion": "2017-12-01", "dependsOn": ["[resourceId(\'Microsoft.Network/loadBalancers\', variables(\'loadBalancerName\'))]", "[resourceId(\'Microsoft.Network/virtualNetworks\', variables(\'virtualNetworkName\'))]"], "sku": {"name": "Standard_A1_v2", "tier": "Standard", "capacity": "[parameters(\'instanceCount\')]"}, "properties": {"overprovision": true, "upgradePolicy": {"mode": "Manual"}, "virtualMachineProfile": {"storageProfile": {"osDisk": {"createOption": "FromImage", "caching": "ReadWrite"}, "imageReference": "[variables(\'imageReference\')]"}, "osProfile": {"computerNamePrefix": "[parameters(\'vmssName\')]", "adminUsername": "[parameters(\'adminUsername\')]", "adminPassword": "[parameters(\'adminPasswordOrKey\')]", "linuxConfiguration": "[if(equals(parameters(\'authenticationType\'), \'password\'), json(\'null\'), variables(\'linuxConfiguration\'))]"}, "networkProfile": {"networkInterfaceConfigurations": [{"name": "[variables(\'nicName\')]", "properties": {"networkSecurityGroup": {"id": "[resourceId(\'Microsoft.Network/networkSecurityGroups\', variables(\'networkSecurityGroupName\'))]"}, "primary": true, "ipConfigurations": [{"name": "[variables(\'ipConfigName\')]", "properties": {"subnet": {"id": "[resourceId(\'Microsoft.Network/virtualNetworks/subnets\', variables(\'virtualNetworkName\'), variables(\'subnetName\'))]"}, "loadBalancerBackendAddressPools": [{"id": "[resourceId(\'Microsoft.Network/loadBalancers/backendAddressPools\', variables(\'loadBalancerName\'), variables(\'bePoolName\'))]"}], "loadBalancerInboundNatPools": [{"id": "[resourceId(\'Microsoft.Network/loadBalancers/inboundNatPools/\', variables(\'loadBalancerName\'), variables(\'natPoolName\'))]"}]}}]}}]}}}}]}


cli_script
Below is the translated bash script for the provided ARM template and template parameters:\n\n```bash\n#!/bin/bash\n\n# Assign the parameter values to variables\nlocation="westus"\nadminUsername="zytest"\nubuntuOSVersion="16.04-LTS"\nvmssName="zytest"\ninstanceCount=3\nauthenticationType="sshPublicKey"\nadminPasswordOrKey="zytest"\n\n# Use the variables to create resources using Azure CLI\n\n# Create a virtual network\naz network vnet create \\\n    --name "${vmssName}vnet" \\\n    --location "$location" \\\n    --address-prefixes "10.0.0.0/16" \\\n    --subnet-name "${vmssName}subnet" \\\n    --subnet-prefix "10.0.0.0/24"\n\n# Create a network security group\naz network nsg create \\\n    --name "allowRemoting" \\\n    --location "$location"\n\n# Define network security rules\naz network nsg rule create \\\n    --nsg-name "allowRemoting" \\\n    --name "remoteConnection" \\\n    --description "Allow RDP traffic" \\\n    --protocol Tcp \\\n    --source-port-ranges "*" \\\n    --destination-port-ranges "22" \\\n    --source-address-prefixes "*" \\\n    --destination-address-prefixes "*" \\\n    --access Allow \\\n    --priority 101 \\\n    --direction Inbound\n\naz network nsg rule create \\\n    --nsg-name "allowRemoting" \\\n    --name "webTraffic" \\\n    --description "Allow web traffic" \\\n    --protocol Tcp \\\n    --source-port-ranges "80" \\\n    --destination-port-ranges "80" \\\n    --source-address-prefixes "*" \\\n    --destination-address-prefixes "*" \\\n    --access Allow \\\n    --priority 100 \\\n    --direction Inbound\n\n# Create a public IP address\naz network public-ip create \\\n    --name "lbPublicIp" \\\n    --location "$location" \\\n    --allocation-method Static \\\n    --sku Standard \\\n    --dns-name "${vmssName,,}"\n\n# Create a load balancer\naz network lb create \\\n    --name "${vmssName}lb" \\\n    --location "$location" \\\n    --sku Standard \\\n    --public-ip-address "lbPublicIp" \\\n    --backend-pool-name "${vmssName}bepool"\n\n# Create a NAT pool for the load balancer\naz network lb inbound-nat-pool create \\\n    --lb-name "${vmssName}lb" \\\n    --name "${vmssName}natpool" \\\n    --protocol Tcp \\\n    --frontend-port-range-start 50000 \\\n    --frontend-port-range-end 50099 \\\n    --backend-port 22 \\\n    --frontend-ip-name "LoadBalancerFrontEnd"\n\n# Create a virtual machine scale set\naz vmss create \\\n    --name "$vmssName" \\\n    --resource-group <ResourceGroupName> \\ # Replace <ResourceGroupName> with your actual resource group name\n    --location "$location" \\\n    --zones 1 \\\n    --vm-sku "Standard_A1_v2" \\\n    --instance-count "$instanceCount" \\\n    --admin-username "$adminUsername" \\\n    --admin-password "$adminPasswordOrKey" \\\n    --authentication-type "$authenticationType" \\\n    --image "Canonical:UbuntuServer:$ubuntuOSVersion:latest" \\\n    --vnet-name "${vmssName}vnet" \\\n    --subnet "${vmssName}subnet" \\\n    --nsg "allowRemoting" \\\n    --backend-pool-name "${vmssName}bepool" \\\n    --nat-pool "${vmssName}natpool"\n```\n\nPlease replace `<ResourceGroupName>` with your actual resource group name before executing the script.\n\nThis script assumes that the Azure CLI is installed and you are logged in with the necessary permissions to create the resources in the specified subscription and resource group.


verify_result
