arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmSize": {"type": "string", "metadata": {"description": "Virtual Machine size"}, "defaultValue": "zytest"}, "adminUsername": {"type": "string", "metadata": {"description": "Username to access virtual Machines"}, "defaultValue": "zytest"}, "adminPassword": {"type": "securestring", "minLength": 12, "metadata": {"description": "Password to access virtual Machines"}, "defaultValue": "zytest"}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "variables": {"storageAccountName": "[concat(uniqueString(resourceGroup().id),\'storage\')]", "vmNSGName": "ExistingNsg", "ipAddressName": "ExistingPip", "virtualNetworkName": "ExistingVNet", "vmNicName": "ExistingNic", "vmName": "ExistingWinVm"}, "resources": [{"type": "Microsoft.Storage/storageAccounts", "name": "[variables(\'storageAccountName\')]", "apiVersion": "2020-08-01-preview", "location": "[parameters(\'location\')]", "comments": "Storage account used to store VM disks", "tags": {"displayName": "Storage Account"}, "sku": {"name": "Standard_LRS"}, "kind": "Storage", "properties": {}}, {"type": "Microsoft.Network/networkSecurityGroups", "name": "[variables(\'vmNSGName\')]", "apiVersion": "2016-03-30", "location": "[parameters(\'location\')]", "comments": "NSG for the VM subnet.", "tags": {"displayName": "VM NSG"}}, {"type": "Microsoft.Network/publicIPAddresses", "name": "[variables(\'ipAddressName\')]", "apiVersion": "2016-03-30", "location": "[parameters(\'location\')]", "comments": " Public IP used by the Jump VM", "tags": {"displayName": "VM Public IP"}, "properties": {"publicIPAllocationMethod": "Static", "idleTimeoutInMinutes": 4}}, {"type": "Microsoft.Network/virtualNetworks", "name": "[variables(\'virtualNetworkName\')]", "apiVersion": "2016-03-30", "location": "[parameters(\'location\')]", "comments": "Virtual network for overall solution", "tags": {"displayName": "Virtual Network"}, "dependsOn": ["[resourceId(\'Microsoft.Network/networkSecurityGroups\', variables(\'vmNSGName\'))]"], "properties": {"addressSpace": {"addressPrefixes": ["10.0.0.0/16"]}, "subnets": [{"name": "default", "properties": {"addressPrefix": "10.0.1.0/24", "networkSecurityGroup": {"id": "[resourceId(\'Microsoft.Network/networkSecurityGroups\', variables(\'vmNSGName\'))]"}}}]}}, {"type": "Microsoft.Network/networkInterfaces", "name": "[variables(\'vmNicName\')]", "apiVersion": "2016-03-30", "location": "[parameters(\'location\')]", "comments": "NIC for the VM", "tags": {"displayName": "VM NIC"}, "dependsOn": ["[resourceId(\'Microsoft.Network/virtualNetworks\', variables(\'virtualNetworkName\'))]"], "properties": {"ipConfigurations": [{"name": "ipconfig1", "properties": {"privateIPAllocationMethod": "Dynamic", "publicIPAddress": {"id": "[resourceId(\'Microsoft.Network/publicIPAddresses\',variables(\'ipAddressName\'))]"}, "subnet": {"id": "[resourceId(\'Microsoft.Network/virtualNetworks/subnets\', variables(\'virtualNetworkName\'),\'default\')]"}}}]}}, {"type": "Microsoft.Compute/virtualMachines", "name": "[variables(\'vmName\')]", "apiVersion": "2017-03-30", "location": "[parameters(\'location\')]", "comments": "Windows VM", "tags": {"displayName": "Virtual Machine"}, "dependsOn": ["[resourceId(\'Microsoft.Storage/storageAccounts\', variables(\'storageAccountName\'))]", "[resourceId(\'Microsoft.Network/networkInterfaces\', variables(\'vmNicName\'))]"], "properties": {"hardwareProfile": {"vmSize": "[parameters(\'vmSize\')]"}, "osProfile": {"computerName": "windowsvm", "adminUsername": "[parameters(\'adminUsername\')]", "adminPassword": "[parameters(\'adminPassword\')]", "windowsConfiguration": {"provisionVmAgent": "true"}}, "storageProfile": {"imageReference": {"publisher": "MicrosoftSQLServer", "offer": "SQL2014SP2-WS2012R2", "sku": "Enterprise", "version": "latest"}, "osDisk": {"name": "[concat(variables(\'vmName\'), \'_OSDisk\')]", "caching": "ReadWrite", "createOption": "FromImage"}, "dataDisks": [{"name": "[concat(variables(\'vmName\'), \'_DataDisk1\')]", "createOption": "Empty", "lun": 0, "diskSizeGB": 1023, "caching": "ReadOnly"}]}, "networkProfile": {"networkInterfaces": [{"id": "[resourceId(\'Microsoft.Network/networkInterfaces\', variables(\'vmNicName\'))]"}]}, "diagnosticsProfile": {"bootDiagnostics": {"enabled": true, "storageUri": "[reference(resourceId(\'Microsoft.Storage/storageAccounts/\', variables(\'storageAccountName\'))).primaryEndpoints.blob]"}}}}, {"apiVersion": "2020-12-01", "type": "Microsoft.Compute/virtualMachines/extensions", "name": "[concat(variables(\'vmName\'), \'/SqlIaasExtension\')]", "location": "[parameters(\'location\')]", "dependsOn": ["[resourceId(\'Microsoft.Compute/virtualMachines\', variables(\'vmName\'))]"], "properties": {"type": "SqlIaaSAgent", "publisher": "Microsoft.SqlServer.Management", "typeHandlerVersion": "1.2", "autoUpgradeMinorVersion": "true", "settings": {"AutoTelemetrySettings": {"Region": "[parameters(\'location\')]"}, "AutoPatchingSettings": {"PatchCategory": "WindowsMandatoryUpdates", "Enable": true, "DayOfWeek": "Sunday", "MaintenanceWindowStartingHour": "2", "MaintenanceWindowDuration": "60"}, "KeyVaultCredentialSettings": {"Enable": false}, "ServerConfigurationsManagementSettings": {"SQLConnectivityUpdateSettings": {"ConnectivityType": "Private", "Port": "1433"}, "SQLWorkloadTypeUpdateSettings": {"SQLWorkloadType": "GENERAL"}, "SQLStorageUpdateSettings": {"DiskCount": "1", "NumberOfColumns": "1", "StartingDeviceID": "2", "DiskConfigurationType": "NEW"}, "AdditionalFeaturesServerConfigurations": {"IsRServicesEnabled": "false"}}}}}], "outputs": {"existingVirtualMachineName": {"type": "string", "value": "[variables(\'vmName\')]"}}}


cli_script
Below is the translated Azure CLI script from the given ARM template and parameters:\n\n```bash\n#!/bin/bash\n\n# Assigning parameter values to variables\nvmSize="zytest" # Virtual Machine size\nadminUsername="zytest" # Username to access virtual Machines\nadminPassword="zytest" # Password to access virtual Machines\nlocation="westus" # Location for all resources.\n\n# Static names for resources (derived from variables in the ARM template)\nstorageAccountName=$(az group show --query name | tr -d \'"\' | xargs -I {} az storage account check-name --name $(echo {} | tr -d \'\\n\' | sha1sum | cut -c1-24) --query name | tr -d \'"\')\nvmNSGName="ExistingNsg"\nipAddressName="ExistingPip"\nvirtualNetworkName="ExistingVNet"\nvmNicName="ExistingNic"\nvmName="ExistingWinVm"\n\n# Create a storage account used to store VM disks\n# Storage account used to store VM disks\naz storage account create \\\n    --name $storageAccountName \\\n    --location $location \\\n    --tags displayName="Storage Account" \\\n    --sku Standard_LRS \\\n    --kind Storage\n\n# Create an NSG for the VM subnet\n# NSG for the VM subnet\naz network nsg create \\\n    --name $vmNSGName \\\n    --location $location \\\n    --tags displayName="VM NSG"\n\n# Create a public IP used by the Jump VM\n# Public IP used by the Jump VM\naz network public-ip create \\\n    --name $ipAddressName \\\n    --location $location \\\n    --tags displayName="VM Public IP" \\\n    --allocation-method Static \\\n    --idle-timeout 4\n\n# Create a virtual network for overall solution\n# Virtual network for overall solution\naz network vnet create \\\n    --name $virtualNetworkName \\\n    --location $location \\\n    --tags displayName="Virtual Network" \\\n    --address-prefixes "10.0.0.0/16" \\\n    --subnet-name "default" \\\n    --subnet-prefixes "10.0.1.0/24" \\\n    --network-security-group $vmNSGName\n\n# Create a NIC for the VM\n# NIC for the VM\naz network nic create \\\n    --name $vmNicName \\\n    --location $location \\\n    --tags displayName="VM NIC" \\\n    --vnet-name $virtualNetworkName \\\n    --subnet "default" \\\n    --public-ip-address $ipAddressName\n\n# Create a Windows VM\n# Windows VM\naz vm create \\\n    --name $vmName \\\n    --location $location \\\n    --tags displayName="Virtual Machine" \\\n    --size $vmSize \\\n    --admin-username $adminUsername \\\n    --admin-password $adminPassword \\\n    --nics $vmNicName \\\n    --image "MicrosoftSQLServer:SQL2014SP2-WS2012R2:Enterprise:latest" \\\n    --storage-sku Standard_LRS \\\n    --os-disk-name "${vmName}_OSDisk" \\\n    --data-disk-sizes-gb 1023 \\\n    --data-disk-caching ReadOnly\n\n# Create SqlIaasExtension for the VM\naz vm extension set \\\n    --vm-name $vmName \\\n    --name "SqlIaasExtension" \\\n    --publisher "Microsoft.SqlServer.Management" \\\n    --settings "{\\"AutoTelemetrySettings\\":{\\"Region\\":\\"$location\\"},\\"AutoPatchingSettings\\":{\\"PatchCategory\\":\\"WindowsMandatoryUpdates\\",\\"Enable\\":true,\\"DayOfWeek\\":\\"Sunday\\",\\"MaintenanceWindowStartingHour\\":2,\\"MaintenanceWindowDuration\\":60},\\"KeyVaultCredentialSettings\\":{\\"Enable\\":false},\\"ServerConfigurationsManagementSettings\\":{\\"SQLConnectivityUpdateSettings\\":{\\"ConnectivityType\\":\\"Private\\",\\"Port\\":\\"1433\\"},\\"SQLWorkloadTypeUpdateSettings\\":{\\"SQLWorkloadType\\":\\"GENERAL\\"},\\"SQLStorageUpdateSettings\\":{\\"DiskCount\\":\\"1\\",\\"NumberOfColumns\\":\\"1\\",\\"StartingDeviceID\\":\\"2\\",\\"DiskConfigurationType\\":\\"NEW\\"},\\"AdditionalFeaturesServerConfigurations\\":{\\"IsRServicesEnabled\\":\\"false\\"}}}" \\\n    --version "1.2"\n\n# Output the name of the created VM\necho "The name of the created VM is: $vmName"\n```\n\nPlease note that this script assumes you have the Azure CLI installed and are logged into an Azure account with sufficient permissions to create these resources. Some values like the storage account name are generated using unique string functions and may need to be adjusted based on your specific requirements. The script also assumes you are executing it within the context of an Azure Resource Group.


verify_result
