arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "defaultValue": "simpleLinuxVM", "metadata": {"description": "The name of you Virtual Machine."}}, "adminUsername": {"type": "string", "metadata": {"description": "Username for the Virtual Machine."}, "defaultValue": "zytest"}, "authenticationType": {"type": "string", "defaultValue": "password", "allowedValues": ["sshPublicKey", "password"], "metadata": {"description": "Type of authentication to use on the Virtual Machine. SSH key is recommended."}}, "adminPasswordOrKey": {"type": "securestring", "metadata": {"description": "SSH Key or password for the Virtual Machine. SSH key is recommended."}, "defaultValue": "zytest"}, "dnsLabelPrefix": {"type": "string", "defaultValue": "[toLower(concat(\'simplelinuxvm-\', uniqueString(resourceGroup().id)))]", "metadata": {"description": "Unique DNS Name for the Public IP used to access the Virtual Machine."}}, "ubuntuOSVersion": {"type": "string", "defaultValue": "18.04-LTS", "allowedValues": ["12.04.5-LTS", "14.04.5-LTS", "16.04.0-LTS", "18.04-LTS"], "metadata": {"description": "The Ubuntu version for the VM. This will pick a fully patched image of this given Ubuntu version."}}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}, "VmSize": {"type": "string", "defaultValue": "Standard_B2s", "metadata": {"description": "The size of the VM"}}, "virtualNetworkName": {"type": "string", "defaultValue": "vNet", "metadata": {"description": "Name of the VNET"}}, "subnetName": {"type": "string", "defaultValue": "Subnet", "metadata": {"description": "Name of the subnet in the virtual network"}}, "networkSecurityGroupName": {"type": "string", "defaultValue": "SecGroupNet", "metadata": {"description": "Name of the Network Security Group"}}}, "variables": {"vmName": "[parameters(\'vmName\')]", "publicIpAddressName": "[concat(parameters(\'vmName\'), \'PublicIP\' )]", "networkInterfaceName": "[concat(parameters(\'vmName\'),\'NetInt\')]", "subnetRef": "[resourceId(\'Microsoft.Network/virtualNetworks/subnets\', parameters(\'virtualNetworkName\'), parameters(\'subnetName\'))]", "osDiskType": "StandardSSD_LRS", "subnetAddressPrefix": "10.1.0.0/24", "addressPrefix": "10.1.0.0/16", "linuxConfiguration": {"disablePasswordAuthentication": true, "ssh": {"publicKeys": [{"path": "[concat(\'/home/\', parameters(\'adminUsername\'), \'/.ssh/authorized_keys\')]", "keyData": "[parameters(\'adminPasswordOrKey\')]"}]}}}, "resources": [{"type": "Microsoft.Network/networkInterfaces", "apiVersion": "2020-06-01", "name": "[variables(\'networkInterfaceName\')]", "location": "[parameters(\'location\')]", "dependsOn": ["[resourceId(\'Microsoft.Network/networkSecurityGroups/\', parameters(\'networkSecurityGroupName\'))]", "[resourceId(\'Microsoft.Network/virtualNetworks/\', parameters(\'virtualNetworkName\'))]", "[resourceId(\'Microsoft.Network/publicIpAddresses/\', variables(\'publicIpAddressName\'))]"], "properties": {"ipConfigurations": [{"name": "ipconfig1", "properties": {"subnet": {"id": "[variables(\'subnetRef\')]"}, "privateIPAllocationMethod": "Dynamic", "publicIpAddress": {"id": "[resourceId(\'Microsoft.Network/publicIPAddresses\',variables(\'publicIPAddressName\'))]"}}}], "networkSecurityGroup": {"id": "[resourceId(\'Microsoft.Network/networkSecurityGroups\',parameters(\'networkSecurityGroupName\'))]"}}}, {"type": "Microsoft.Network/networkSecurityGroups", "apiVersion": "2020-06-01", "name": "[parameters(\'networkSecurityGroupName\')]", "location": "[parameters(\'location\')]", "properties": {"securityRules": [{"name": "SSH", "properties": {"priority": 1000, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "22"}}]}}, {"type": "Microsoft.Network/virtualNetworks", "apiVersion": "2020-06-01", "name": "[parameters(\'virtualNetworkName\')]", "location": "[parameters(\'location\')]", "properties": {"addressSpace": {"addressPrefixes": ["[variables(\'addressPrefix\')]"]}, "subnets": [{"name": "[parameters(\'subnetName\')]", "properties": {"addressPrefix": "[variables(\'subnetAddressPrefix\')]", "privateEndpointNetworkPolicies": "Enabled", "privateLinkServiceNetworkPolicies": "Enabled"}}]}}, {"type": "Microsoft.Network/publicIpAddresses", "apiVersion": "2020-06-01", "name": "[variables(\'publicIpAddressName\')]", "location": "[parameters(\'location\')]", "sku": {"name": "Basic", "tier": "Regional"}, "properties": {"publicIpAllocationMethod": "Dynamic", "publicIPAddressVersion": "IPv4", "dnsSettings": {"domainNameLabel": "[parameters(\'dnsLabelPrefix\')]"}, "idleTimeoutInMinutes": 4}}, {"type": "Microsoft.Compute/virtualMachines", "apiVersion": "2020-06-01", "name": "[parameters(\'vmName\')]", "location": "[parameters(\'location\')]", "dependsOn": ["[resourceId(\'Microsoft.Network/networkInterfaces/\', variables(\'networkInterfaceName\'))]"], "properties": {"hardwareProfile": {"vmSize": "[parameters(\'VmSize\')]"}, "storageProfile": {"osDisk": {"createOption": "fromImage", "managedDisk": {"storageAccountType": "[variables(\'osDiskType\')]"}}, "imageReference": {"publisher": "Canonical", "offer": "UbuntuServer", "sku": "[parameters(\'ubuntuOSVersion\')]", "version": "latest"}}, "networkProfile": {"networkInterfaces": [{"id": "[resourceId(\'Microsoft.Network/networkInterfaces\', variables(\'networkInterfaceName\'))]"}]}, "osProfile": {"computerName": "[parameters(\'vmName\')]", "adminUsername": "[parameters(\'adminUsername\')]", "adminPassword": "[parameters(\'adminPasswordOrKey\')]", "linuxConfiguration": "[if(equals(parameters(\'authenticationType\'), \'password\'), json(\'null\'), variables(\'linuxConfiguration\'))]"}}}], "outputs": {"vmName": {"type": "string", "value": "[variables(\'vmName\')]"}}}


cli_script
```bash\n#!/bin/bash\n\n# Define the parameters as variables\nvmName="simpleLinuxVM"\nadminUsername="zytest"\nauthenticationType="password"\nadminPasswordOrKey="zytest"\ndnsLabelPrefix=$(echo "simplelinuxvm-$(uuidgen | tr \'[:upper:]\' \'[:lower:]\')" | cut -c 1-24) # Unique DNS Name for the Public IP used to access the Virtual Machine.\nubuntuOSVersion="18.04-LTS"\nlocation="westus"\nVmSize="Standard_B2s"\nvirtualNetworkName="vNet"\nsubnetName="Subnet"\nnetworkSecurityGroupName="SecGroupNet"\n\n# Define the variables\npublicIpAddressName="${vmName}PublicIP"\nnetworkInterfaceName="${vmName}NetInt"\nsubnetRef="" # This will be set after creating the virtual network and subnet\nosDiskType="StandardSSD_LRS"\nsubnetAddressPrefix="10.1.0.0/24"\naddressPrefix="10.1.0.0/16"\n\n# Create a Network Security Group\naz network nsg create \\\n  --name $networkSecurityGroupName \\\n  --resource-group $resourceGroup \\\n  --location $location\n\n# Create a Virtual Network\naz network vnet create \\\n  --name $virtualNetworkName \\\n  --resource-group $resourceGroup \\\n  --location $location \\\n  --address-prefix $addressPrefix\n\n# Create a Subnet\naz network vnet subnet create \\\n  --name $subnetName \\\n  --resource-group $resourceGroup \\\n  --vnet-name $virtualNetworkName \\\n  --address-prefix $subnetAddressPrefix\n\n# Get the subnet ID\nsubnetRef=$(az network vnet subnet show \\\n  --resource-group $resourceGroup \\\n  --vnet-name $virtualNetworkName \\\n  --name $subnetName \\\n  --query id -o tsv)\n\n# Create a Public IP Address\naz network public-ip create \\\n  --name $publicIpAddressName \\\n  --resource-group $resourceGroup \\\n  --location $location \\\n  --allocation-method Dynamic \\\n  --dns-name $dnsLabelPrefix\n\n# Create a Network Interface\naz network nic create \\\n  --name $networkInterfaceName \\\n  --resource-group $resourceGroup \\\n  --location $location \\\n  --subnet $subnetRef \\\n  --network-security-group $networkSecurityGroupName \\\n  --public-ip-address $publicIpAddressName\n\n# Create a Virtual Machine\naz vm create \\\n  --name $vmName \\\n  --resource-group $resourceGroup \\\n  --location $location \\\n  --nics $networkInterfaceName \\\n  --size $VmSize \\\n  --image UbuntuLTS \\\n  --admin-username $adminUsername \\\n  --authentication-type $authenticationType \\\n  --admin-password-or-ssh-key $adminPasswordOrKey \\\n  --os-disk-size-gb 30 \\\n  --os-disk-name "${vmName}OsDisk" \\\n  --os-type Linux\n\n# Output the VM name\necho "VM Name: $vmName"\n```\n\nPlease note that the above script assumes that you have an existing resource group named `$resourceGroup`. If you don\'t have one, you\'ll need to create it using the `az group create` command before running the above script.\n\nAlso, the `dnsLabelPrefix` calculation in the script is an approximation of the ARM template\'s `toLower(concat(\'simplelinuxvm-\', uniqueString(resourceGroup().id)))`. Since the `uniqueString` function is not available in bash, I\'ve used `uuidgen` to generate a unique string and trimmed it to a maximum of 24 characters to ensure it fits within the constraints for a DNS label prefix.\n\nThe script also assumes the default values provided in the ARM template parameters and will create resources based on those values. If you need to use different values, you can modify the variables at the beginning of the script accordingly.


verify_result
