arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "defaultValue": "zytest"}, "networkSecurityGroupName": {"type": "string", "defaultValue": "zytest"}, "publicIPAddressName": {"type": "string", "defaultValue": "zytest"}, "existingVnetLocation": {"type": "string", "defaultValue": "zytest"}}, "variables": {}, "resources": [{"apiVersion": "2016-03-30", "type": "Microsoft.Network/publicIPAddresses", "name": "[parameters(\'publicIPAddressName\')]", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"publicIPAllocationMethod": "Dynamic"}}, {"name": "[parameters(\'networkSecurityGroupName\')]", "type": "Microsoft.Network/networkSecurityGroups", "apiVersion": "2016-09-01", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"securityRules": [{"name": "default-allow-rdp", "properties": {"priority": 1000, "sourceAddressPrefix": "*", "protocol": "Tcp", "destinationPortRange": "3389", "access": "Allow", "direction": "Inbound", "sourcePortRange": "*", "destinationAddressPrefix": "*"}}]}}], "outputs": {"hostname": {"type": "string", "value": ""}}}


cli_script
Here is the equivalent CLI script:\n\n```bash\n#!/bin/bash\n\n# Define parameters\nvmName="zytest"\nnetworkSecurityGroupName="zytest"\npublicIPAddressName="zytest"\nexistingVnetLocation="zytest"\n\n# Create a public IP address\naz network public-ip create --name $publicIPAddressName --location $existingVnetLocation --allocation-method Dynamic --tags vmname=$vmName\n\n# Create a network security group\naz network nsg create --name $networkSecurityGroupName --location $existingVnetLocation --tags vmname=$vmName\n\n# Add a security rule to the network security group\naz network nsg rule create --nsg-name $networkSecurityGroupName --name default-allow-rdp --priority 1000 --source-address-prefixes \'*\' --destination-port-ranges 3389 --access Allow --protocol Tcp --direction Inbound --source-port-ranges \'*\' --destination-address-prefixes \'*\'\n```\n\nThis script first defines the parameters, then creates a public IP address and a network security group, and finally adds a security rule to the network security group.


verify_result
