arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"existingVirtualMachineName": {"type": "string", "metadata": {"description": "Existing SQL Server virtual machine name."}, "defaultValue": "zytest"}, "sqlAutopatchingDayOfWeek": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Day of A Week"}, "allowedValues": ["Everyday", "Never", "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], "defaultValue": "Sunday"}, "sqlAutopatchingStartHour": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Starting Hour"}, "allowedValues": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"], "defaultValue": "2"}, "sqlAutopatchingWindowDuration": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Duration Window in minutes"}, "allowedValues": ["30", "60", "90", "120", "150", "180"], "defaultValue": "60"}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "resources": [{"apiVersion": "2020-12-01", "type": "Microsoft.Compute/virtualMachines/extensions", "name": "[concat(parameters(\'existingVirtualMachineName\'), \'/SqlIaasExtension\')]", "location": "[parameters(\'location\')]", "properties": {"type": "SqlIaaSAgent", "publisher": "Microsoft.SqlServer.Management", "typeHandlerVersion": "1.2", "autoUpgradeMinorVersion": "true", "settings": {"AutoPatchingSettings": {"PatchCategory": "WindowsMandatoryUpdates", "Enable": true, "DayOfWeek": "[parameters(\'sqlAutopatchingDayOfWeek\')]", "MaintenanceWindowStartingHour": "[parameters(\'sqlAutopatchingStartHour\')]", "MaintenanceWindowDuration": "[parameters(\'sqlAutopatchingWindowDuration\')]"}}}}], "outputs": {}}


cli_script
Below is the bash script that translates the given ARM template and parameters into Azure CLI commands:\n\n```bash\n#!/bin/bash\n\n# Define the parameters as variables\nexistingVirtualMachineName="zytest" # Existing SQL Server virtual machine name.\nsqlAutopatchingDayOfWeek="Sunday" # SQL Server Auto Patching Day of A Week\nsqlAutopatchingStartHour="2" # SQL Server Auto Patching Starting Hour\nsqlAutopatchingWindowDuration="60" # SQL Server Auto Patching Duration Window in minutes\nlocation="westus" # Location for all resources.\n\n# Deploy the SQL IaaS Extension to the specified virtual machine\naz vm extension set \\\n  --resource-group <ResourceGroup> \\\n  --vm-name $existingVirtualMachineName \\\n  --name SqlIaasExtension \\\n  --publisher Microsoft.SqlServer.Management \\\n  --version 1.2 \\\n  --settings "{\\"AutoPatchingSettings\\": {\\"PatchCategory\\": \\"WindowsMandatoryUpdates\\", \\"Enable\\": true, \\"DayOfWeek\\": \\"$sqlAutopatchingDayOfWeek\\", \\"MaintenanceWindowStartingHour\\": \\"$sqlAutopatchingStartHour\\", \\"MaintenanceWindowDuration\\": \\"$sqlAutopatchingWindowDuration\\"}}" \\\n  --location $location \\\n  --no-auto-upgrade-minor-version false\n\n# Note: Replace <ResourceGroup> with your actual resource group name.\n```\n\nPlease replace `<ResourceGroup>` with the actual name of the resource group where your virtual machine is located. The script sets up the SQL IaaS Extension on an Azure VM with the given autopatching settings.


verify_result
