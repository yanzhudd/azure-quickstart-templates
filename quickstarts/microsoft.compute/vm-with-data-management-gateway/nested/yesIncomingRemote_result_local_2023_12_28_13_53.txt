arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "defaultValue": "zytest"}, "networkSecurityGroupName": {"type": "string", "defaultValue": "zytest"}, "publicIPAddressName": {"type": "string", "defaultValue": "zytest"}, "existingVnetLocation": {"type": "string", "defaultValue": "zytest"}}, "variables": {"dnsLabelPrefix": "[concat(toLower(parameters(\'vmName\')), uniquestring(resourceGroup().id, parameters(\'vmName\')))]"}, "resources": [{"apiVersion": "2016-03-30", "type": "Microsoft.Network/publicIPAddresses", "name": "[parameters(\'publicIPAddressName\')]", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"publicIPAllocationMethod": "Dynamic", "dnsSettings": {"domainNameLabel": "[variables(\'dnsLabelPrefix\')]"}}}, {"name": "[parameters(\'networkSecurityGroupName\')]", "type": "Microsoft.Network/networkSecurityGroups", "apiVersion": "2016-09-01", "location": "[parameters(\'existingVnetLocation\')]", "tags": {"vmname": "[parameters(\'vmName\')]"}, "properties": {"securityRules": [{"name": "default-allow-rdp", "properties": {"priority": 1000, "sourceAddressPrefix": "*", "protocol": "Tcp", "destinationPortRange": "3389", "access": "Allow", "direction": "Inbound", "sourcePortRange": "*", "destinationAddressPrefix": "*"}}, {"name": "ResourceManager", "properties": {"priority": 1010, "sourceAddressPrefix": "*", "protocol": "Tcp", "destinationPortRange": "8050", "access": "Allow", "direction": "Inbound", "sourcePortRange": "*", "destinationAddressPrefix": "*"}}]}}], "outputs": {"hostname": {"type": "string", "value": "[reference(parameters(\'publicIPAddressName\')).dnsSettings.fqdn]"}}}


cli_script
Below is the equivalent Azure CLI script translated from the provided ARM template and parameters. The parameters have been converted into variables, and each resource item in the ARM template has been translated into the corresponding Azure CLI command.\n\n```bash\n#!/bin/bash\n\n# Variables from template parameters\nvmName="zytest"\nnetworkSecurityGroupName="zytest"\npublicIPAddressName="zytest"\nexistingVnetLocation="zytest"\n\n# Unique DNS Label Prefix generated using the vmName and Resource Group ID\ndnsLabelPrefix=$(echo "$vmName"$(az group show --name $(az group list --query \'[].name\' --output tsv) --query id --output tsv) | tr \'[:upper:]\' \'[:lower:]\' | md5sum | head -c 8)\n\n# Create Public IP Address\naz network public-ip create \\\n    --name $publicIPAddressName \\\n    --location $existingVnetLocation \\\n    --tags vmname=$vmName \\\n    --allocation-method Dynamic \\\n    --dns-name $dnsLabelPrefix \\\n    --output json\n\n# Create Network Security Group\naz network nsg create \\\n    --name $networkSecurityGroupName \\\n    --location $existingVnetLocation \\\n    --tags vmname=$vmName \\\n    --output json\n\n# Add security rule "default-allow-rdp" to the Network Security Group\naz network nsg rule create \\\n    --nsg-name $networkSecurityGroupName \\\n    --name "default-allow-rdp" \\\n    --priority 1000 \\\n    --source-address-prefixes \'*\' \\\n    --source-port-ranges \'*\' \\\n    --destination-address-prefixes \'*\' \\\n    --destination-port-ranges 3389 \\\n    --access Allow \\\n    --protocol Tcp \\\n    --direction Inbound \\\n    --output json\n\n# Add security rule "ResourceManager" to the Network Security Group\naz network nsg rule create \\\n    --nsg-name $networkSecurityGroupName \\\n    --name "ResourceManager" \\\n    --priority 1010 \\\n    --source-address-prefixes \'*\' \\\n    --source-port-ranges \'*\' \\\n    --destination-address-prefixes \'*\' \\\n    --destination-port-ranges 8050 \\\n    --access Allow \\\n    --protocol Tcp \\\n    --direction Inbound \\\n    --output json\n\n# Get the FQDN of the Public IP Address and store it in a variable\nhostname=$(az network public-ip show --name $publicIPAddressName --query "dnsSettings.fqdn" --output tsv)\n\n# Output the hostname\necho "The FQDN of the Public IP Address is: $hostname"\n```\n\nThis script assumes that you are already logged into Azure CLI and have the appropriate permissions to create these resources in your subscription. The script sets up a Public IP Address and a Network Security Group with two inbound security rules. It also outputs the fully qualified domain name (FQDN) of the public IP address.


verify_result
