arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "metadata": {"description": "Name of the VM"}, "defaultValue": "zytest"}, "osType": {"type": "string", "allowedValues": ["Windows", "Linux"], "metadata": {"description": "Type of OS on the existing vhd"}, "defaultValue": "zytest"}, "osDiskVhdUri": {"type": "string", "metadata": {"description": "Uri of the existing OS VHD in ARM standard or premium storage"}, "defaultValue": "zytest"}, "dataDisk0VhdUri": {"type": "string", "metadata": {"description": "Uri of the existing data disk VHD in ARM standard or premium storage"}, "defaultValue": "zytest"}, "vmSize": {"type": "string", "metadata": {"description": "Size of the VM"}, "defaultValue": "zytest"}, "existingVirtualNetworkName": {"type": "string", "metadata": {"description": "Name of the existing VNET"}, "defaultValue": "zytest"}, "existingVirtualNetworkResourceGroup": {"type": "string", "defaultValue": "[resourceGroup().name]", "metadata": {"description": "Name of the existing VNET resource group"}}, "subnetName": {"type": "string", "metadata": {"description": "Name of the subnet in the virtual network you want to use"}, "defaultValue": "zytest"}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "variables": {"diagStorageAccountName": "[concat(parameters(\'vmName\'), \'diag\')]", "publicIPAddressType": "Dynamic", "subnetRef": "[resourceId(parameters(\'existingVirtualNetworkResourceGroup\'), \'Microsoft.Network/virtualNetworks/subnets\', parameters(\'existingVirtualNetworkName\'),  parameters(\'subnetName\'))]", "nicName": "[concat(parameters(\'vmName\'), \'-nic1\')]", "publicIPAddressName": "[concat(parameters(\'vmName\'), \'-pip\')]"}, "resources": [{"apiVersion": "2021-01-01", "type": "Microsoft.Storage/storageAccounts", "name": "[variables(\'diagStorageAccountName\')]", "location": "[parameters(\'location\')]", "sku": {"name": "Standard_GRS"}, "kind": "StorageV2", "properties": {}}, {"apiVersion": "2020-11-01", "type": "Microsoft.Network/publicIPAddresses", "name": "[variables(\'publicIPAddressName\')]", "location": "[parameters(\'location\')]", "tags": {"displayName": "PublicIPAddress"}, "properties": {"publicIPAllocationMethod": "[variables(\'publicIPAddressType\')]"}}, {"apiVersion": "2020-11-01", "type": "Microsoft.Network/networkInterfaces", "name": "[variables(\'nicName\')]", "location": "[parameters(\'location\')]", "dependsOn": ["[resourceId(\'Microsoft.Network/publicIPAddresses/\', variables(\'publicIPAddressName\'))]"], "tags": {"displayName": "NetworkInterface"}, "properties": {"ipConfigurations": [{"name": "ipconfig1", "properties": {"privateIPAllocationMethod": "Dynamic", "publicIPAddress": {"id": "[resourceId(\'Microsoft.Network/publicIPAddresses\',variables(\'publicIPAddressName\'))]"}, "subnet": {"id": "[variables(\'subnetRef\')]"}}}]}}, {"type": "Microsoft.Compute/disks", "apiVersion": "2017-03-30", "name": "[concat(parameters(\'vmName\'), \'_OSdisk\')]", "location": "[parameters(\'location\')]", "properties": {"creationData": {"createOption": "Import", "sourceUri": "[parameters(\'osDiskVhdUri\')]"}, "osType": "[parameters(\'osType\')]"}}, {"type": "Microsoft.Compute/disks", "apiVersion": "2017-03-30", "name": "[concat(parameters(\'vmName\'), \'_Datadisk\')]", "location": "[parameters(\'location\')]", "properties": {"creationData": {"createOption": "Import", "sourceUri": "[parameters(\'dataDisk0VhdUri\')]"}}}, {"apiVersion": "2020-12-01", "type": "Microsoft.Compute/virtualMachines", "name": "[parameters(\'vmName\')]", "location": "[parameters(\'location\')]", "tags": {"displayName": "VirtualMachine"}, "dependsOn": ["[resourceId(\'Microsoft.Network/networkInterfaces/\', variables(\'nicName\'))]", "[resourceId(\'Microsoft.Compute/disks\', concat(parameters(\'vmName\'), \'_OSdisk\'))]", "[resourceId(\'Microsoft.Compute/disks\', concat(parameters(\'vmName\'), \'_Datadisk\'))]"], "properties": {"hardwareProfile": {"vmSize": "[parameters(\'vmSize\')]"}, "storageProfile": {"osDisk": {"osType": "[parameters(\'osType\')]", "caching": "ReadWrite", "createOption": "Attach", "managedDisk": {"id": "[resourceId(\'Microsoft.Compute/disks\', concat(parameters(\'vmName\'), \'_OSdisk\'))]"}}, "dataDisks": [{"lun": 0, "managedDisk": {"id": "[resourceId(\'Microsoft.Compute/disks\', concat(parameters(\'vmName\'), \'_Datadisk\'))]"}, "caching": "ReadOnly", "createOption": "Attach"}]}, "networkProfile": {"networkInterfaces": [{"id": "[resourceId(\'Microsoft.Network/networkInterfaces\',variables(\'nicName\'))]"}]}, "diagnosticsProfile": {"bootDiagnostics": {"enabled": true, "storageUri": "[reference(variables(\'diagStorageAccountName\'), \'2021-02-01\').primaryEndpoints[\'blob\']]"}}}}]}


cli_script
Below is the translated bash script from the provided ARM template and parameters. Please note that I\'ve assumed the `TemplateParameters` are provided with the same names as in the ARM template, so I\'ve used the default values as variables in the script.\n\n```bash\n#!/bin/bash\n\n# Assigning the default values from the ARM template to variables\nvmName="zytest"\nosType="zytest"\nosDiskVhdUri="zytest"\ndataDisk0VhdUri="zytest"\nvmSize="zytest"\nexistingVirtualNetworkName="zytest"\nexistingVirtualNetworkResourceGroup=$(az group show --query name --output tsv)\nsubnetName="zytest"\nlocation="westus"\n\n# Generating dynamic resource names based on the vmName parameter\ndiagStorageAccountName="${vmName}diag"\npublicIPAddressType="Dynamic"\nsubnetRef=$(az network vnet subnet show --resource-group "$existingVirtualNetworkResourceGroup" --vnet-name "$existingVirtualNetworkName" --name "$subnetName" --query id --output tsv)\nnicName="${vmName}-nic1"\npublicIPAddressName="${vmName}-pip"\n\n# Create Storage Account for Diagnostics\naz storage account create \\\n    --name "$diagStorageAccountName" \\\n    --location "$location" \\\n    --sku Standard_GRS \\\n    --kind StorageV2\n\n# Create Public IP Address\naz network public-ip create \\\n    --name "$publicIPAddressName" \\\n    --location "$location" \\\n    --allocation-method "$publicIPAddressType" \\\n    --tags displayName=PublicIPAddress\n\n# Create Network Interface\naz network nic create \\\n    --name "$nicName" \\\n    --location "$location" \\\n    --public-ip-address "$publicIPAddressName" \\\n    --subnet "$subnetRef" \\\n    --tags displayName=NetworkInterface\n\n# Create OS Disk from VHD\naz disk create \\\n    --name "${vmName}_OSdisk" \\\n    --location "$location" \\\n    --os-type "$osType" \\\n    --source "$osDiskVhdUri" \\\n    --creation-option Import\n\n# Create Data Disk from VHD\naz disk create \\\n    --name "${vmName}_Datadisk" \\\n    --location "$location" \\\n    --source "$dataDisk0VhdUri" \\\n    --creation-option Import\n\n# Create Virtual Machine\naz vm create \\\n    --name "$vmName" \\\n    --location "$location" \\\n    --tags displayName=VirtualMachine \\\n    --size "$vmSize" \\\n    --attach-os-disk "${vmName}_OSdisk" \\\n    --attach-data-disks "${vmName}_Datadisk" \\\n    --os-type "$osType" \\\n    --nics "$nicName"\n\n# Enable Boot Diagnostics\nstorageUri=$(az storage account show --name "$diagStorageAccountName" --query "primaryEndpoints.blob" --output tsv)\naz vm boot-diagnostics enable \\\n    --name "$vmName" \\\n    --storage "$storageUri"\n```\n\nPlease replace the default values with the actual parameter values you wish to use before running the script. This script assumes you have the Azure CLI installed and you are logged into your Azure account.


verify_result
