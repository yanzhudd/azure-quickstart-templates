arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vhdUri": {"type": "string", "metadata": {"description": "Storage VHD Uri"}, "defaultValue": "zytest"}, "managedDiskName": {"type": "string", "metadata": {"description": "Name of the managed disk to be copied"}, "defaultValue": "zytest"}, "keyVaultResourceID": {"type": "string", "metadata": {"description": "KeyVault resource id. Ex: /subscriptions/subscriptionid/resourceGroups/contosorg/providers/Microsoft.KeyVault/vaults/contosovault"}, "defaultValue": "zytest"}, "keyVaultSecretUrl": {"type": "string", "metadata": {"description": "KeyVault secret Url. Ex: https://contosovault.vault.azure.net/secrets/contososecret/e088818e865e48488cf363af16dea596"}, "defaultValue": "zytest"}, "useExistingKek": {"type": "string", "defaultValue": "nokek", "allowedValues": ["nokek", "kek"], "metadata": {"description": "Select kek if the secret is encrypted with a key encryption key and pass explicit keyVaultKekUrl. For nokek, you can keep keyVaultKekUrl empty."}}, "kekUrl": {"type": "string", "defaultValue": "", "metadata": {"description": "key encryption key Url. Ex: https://contosovault.vault.azure.net/keys/contosokek/562a4bb76b524a1493a6afe8e536ee78"}}, "kekVaultResourceID": {"type": "string", "defaultValue": "", "metadata": {"description": "key encryption key vault resource id. Ex: /subscriptions/subscriptionid/resourceGroups/contosorg/providers/Microsoft.KeyVault/vaults/contosovault"}}}, "variables": {"createDiskUrl": "[concat(\'https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-create-encrypted-managed-disk/CreateEncryptedManagedDisk-\',parameters(\'useExistingKek\'),\'.json\')]"}, "resources": [{"name": "CreateEncryptedManagedDisk", "type": "Microsoft.Resources/deployments", "apiVersion": "2015-01-01", "properties": {"mode": "Incremental", "templateLink": {"uri": "[variables(\'createDiskUrl\')]", "contentVersion": "1.0.0.0"}, "parameters": {"vhdUri": {"value": "[parameters(\'vhdUri\')]"}, "managedDiskName": {"value": "[parameters(\'managedDiskName\')]"}, "keyVaultResourceID": {"value": "[parameters(\'keyVaultResourceID\')]"}, "keyVaultSecretUrl": {"value": "[parameters(\'keyVaultSecretUrl\')]"}, "kekUrl": {"value": "[parameters(\'kekUrl\')]"}, "kekVaultResourceID": {"value": "[parameters(\'kekVaultResourceID\')]"}}}}]}


cli_script
Here is the equivalent CLI script:\n\n```bash\n#!/bin/bash\n\n# Define parameters\nvhdUri="zytest"\nmanagedDiskName="zytest"\nkeyVaultResourceID="zytest"\nkeyVaultSecretUrl="zytest"\nuseExistingKek="nokek"\nkekUrl=""\nkekVaultResourceID=""\n\n# Define variables\ncreateDiskUrl="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-create-encrypted-managed-disk/CreateEncryptedManagedDisk-$useExistingKek.json"\n\n# Create Encrypted Managed Disk\naz group deployment create --name "CreateEncryptedManagedDisk" --resource-group "myResourceGroup" --template-uri "$createDiskUrl" --parameters vhdUri=$vhdUri managedDiskName=$managedDiskName keyVaultResourceID=$keyVaultResourceID keyVaultSecretUrl=$keyVaultSecretUrl kekUrl=$kekUrl kekVaultResourceID=$kekVaultResourceID\n```\n\nPlease replace `"myResourceGroup"` with your actual resource group name. This script will create an encrypted managed disk in Azure.


verify_result
