arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"existingVirtualMachineName": {"type": "string", "metadata": {"description": "Existing SQL Server virtual machine name."}, "defaultValue": "zytest"}, "sqlAutopatchingDayOfWeek": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Day of A Week"}, "allowedValues": ["Everyday", "Never", "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], "defaultValue": "Sunday"}, "sqlAutopatchingStartHour": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Starting Hour"}, "allowedValues": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"], "defaultValue": "2"}, "sqlAutopatchingWindowDuration": {"type": "string", "metadata": {"description": "SQL Server Auto Patching Duration Window in minutes"}, "allowedValues": ["30", "60", "90", "120", "150", "180"], "defaultValue": "60"}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "resources": [{"apiVersion": "2020-12-01", "type": "Microsoft.Compute/virtualMachines/extensions", "name": "[concat(parameters(\'existingVirtualMachineName\'), \'/SqlIaasExtension\')]", "location": "[parameters(\'location\')]", "properties": {"type": "SqlIaaSAgent", "publisher": "Microsoft.SqlServer.Management", "typeHandlerVersion": "1.2", "autoUpgradeMinorVersion": "true", "settings": {"AutoPatchingSettings": {"PatchCategory": "WindowsMandatoryUpdates", "Enable": true, "DayOfWeek": "[parameters(\'sqlAutopatchingDayOfWeek\')]", "MaintenanceWindowStartingHour": "[parameters(\'sqlAutopatchingStartHour\')]", "MaintenanceWindowDuration": "[parameters(\'sqlAutopatchingWindowDuration\')]"}}}}], "outputs": {}}


cli_script
Below is the bash script that corresponds to the given ARM template and template parameters. The script sets variables based on the parameters provided and then uses Azure CLI commands to create the resources defined in the ARM template.\n\n```bash\n#!/bin/bash\n\n# Assign template parameter values to variables\nexistingVirtualMachineName="zytest" # Existing SQL Server virtual machine name.\nsqlAutopatchingDayOfWeek="Sunday" # SQL Server Auto Patching Day of A Week\nsqlAutopatchingStartHour="2" # SQL Server Auto Patching Starting Hour\nsqlAutopatchingWindowDuration="60" # SQL Server Auto Patching Duration Window in minutes\nlocation="westus" # Location for all resources.\n\n# Create the SQL IaaS Extension on the existing virtual machine\naz vm extension set \\\n    --name SqlIaasExtension \\\n    --publisher Microsoft.SqlServer.Management \\\n    --version 1.2 \\\n    --vm-name $existingVirtualMachineName \\\n    --resource-group <ResourceGroupName> \\ # Replace <ResourceGroupName> with your actual resource group name\n    --location $location \\\n    --settings "{\\"AutoPatchingSettings\\":{\\"PatchCategory\\":\\"WindowsMandatoryUpdates\\",\\"Enable\\":true,\\"DayOfWeek\\":\\"$sqlAutopatchingDayOfWeek\\",\\"MaintenanceWindowStartingHour\\":\\"$sqlAutopatchingStartHour\\",\\"MaintenanceWindowDuration\\":\\"$sqlAutopatchingWindowDuration\\"}}" \\\n    --auto-upgrade-minor-version true \\\n    --no-wait\n\n# Note: The resource group name is not provided in the ARM template or parameters.\n# You must replace <ResourceGroupName> with the actual name of the resource group where your VM is located.\n```\n\nMake sure to replace `<ResourceGroupName>` with the actual name of the resource group where your virtual machine is located. This script assumes that you have the Azure CLI installed and are logged in to an Azure account with the necessary permissions to perform these actions.


verify_result
