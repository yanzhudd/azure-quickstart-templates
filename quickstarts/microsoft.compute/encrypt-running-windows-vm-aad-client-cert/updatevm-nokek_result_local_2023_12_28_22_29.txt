arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmName": {"type": "string", "metadata": {"description": "Name of the Virtual Machine"}, "defaultValue": "zytest"}, "keyVaultResourceID": {"type": "string", "metadata": {"description": "KeyVault resource id. Ex: /subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus"}, "defaultValue": "zytest"}, "keyVaultSecretUrl": {"type": "string", "metadata": {"description": "KeyVault secret Url. Ex: https://diskencryptiontestaus.vault.azure.net/secrets/BitLockerEncryptionSecretWithKek/e088818e865e48488cf363af16dea596"}, "defaultValue": "zytest"}, "keyEncryptionKeyURL": {"type": "string", "defaultValue": "", "metadata": {"description": "KeyVault key encryption key Url. Ex: https://diskencryptiontestaus.vault.azure.net/keys/DiskEncryptionKek/562a4bb76b524a1493a6afe8e536ee78"}}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location for all resources."}}}, "resources": [{"apiVersion": "2016-04-30-preview", "type": "Microsoft.Compute/virtualMachines", "name": "[parameters(\'vmName\')]", "location": "[parameters(\'location\')]", "properties": {"storageProfile": {"osDisk": {"encryptionSettings": {"diskEncryptionKey": {"sourceVault": {"id": "[parameters(\'keyVaultResourceID\')]"}, "secretUrl": "[parameters(\'keyVaultSecretUrl\')]"}}}}}}]}


cli_script
Based on the provided JSON data, here is the equivalent Azure CLI bash script that creates the resources defined in the ARM template:\n\n```bash\n#!/bin/bash\n\n# Template Parameters\nvmName="zytest"\nkeyVaultResourceID="/subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus"\nkeyVaultSecretUrl="https://diskencryptiontestaus.vault.azure.net/secrets/BitLockerEncryptionSecretWithKek/e088818e865e48488cf363af16dea596"\nkeyEncryptionKeyURL="https://diskencryptiontestaus.vault.azure.net/keys/DiskEncryptionKek/562a4bb76b524a1493a6afe8e536ee78"\nlocation="westus"\n\n# Create a Virtual Machine with disk encryption settings\naz vm create \\\n  --name "$vmName" \\\n  --location "$location" \\\n  --encryption-at-host \\\n  --disk-encryption-keyvault "$keyVaultResourceID" \\\n  --disk-encryption-volume-type "ALL" \\\n  --admin-username "your_username" \\\n  --admin-password "your_password" \\\n  --image "Win2019Datacenter" \\\n  --size "Standard_DS1_v2" \\\n  --generate-ssh-keys\n\n# Note: The above command assumes you\'re creating a new VM with Windows Server 2019 Datacenter image and Standard_DS1_v2 size.\n# You need to replace "your_username" and "your_password" with actual admin username and password.\n# Also, the "--encryption-at-host" flag is used to enable encryption at host, which is not explicitly specified in the ARM template.\n# The ARM template does not provide all the required information to fully create a VM (like admin credentials, image, size, etc.),\n# so I\'ve made some assumptions to create a complete CLI command.\n# If you have an existing VM or different requirements, you will need to adjust the command accordingly.\n\n# Enable Disk Encryption\naz vm encryption enable \\\n  --resource-group "your_resource_group" \\\n  --name "$vmName" \\\n  --disk-encryption-keyvault "$keyVaultResourceID" \\\n  --key-encryption-key "$keyEncryptionKeyURL" \\\n  --volume-type "ALL"\n\n# Note: Replace "your_resource_group" with the actual resource group name where the VM is located.\n# The "--volume-type" is set to "ALL" to encrypt both OS and data disks.\n```\n\nPlease replace `"your_username"`, `"your_password"`, and `"your_resource_group"` with the actual values that you intend to use for the virtual machine\'s admin username, password, and the resource group where the VM will reside. The ARM template does not provide all the necessary details for creating a VM, such as the admin credentials, image, and size, so I have included some common defaults and assumptions in the script. Adjust the script as necessary to fit your specific requirements.


verify_result
{"diff_info": ["  ", "  Thedeploymentwillupdatethefollowingscope:", "  ", "  Scope:/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg", "  ", "  -Microsoft.CognitiveServices/accounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.CognitiveServices/accounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"FormRecognizer\\"", "  location:\\"westus2\\"", "  name:\\"cli-translator\\"", "  sku.name:\\"F0\\"", "  type:\\"Microsoft.CognitiveServices/accounts\\"", "  ", "  -Microsoft.DocumentDb/databaseAccounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.DocumentDb/databaseAccounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"GlobalDocumentDB\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.defaultExperience:\\"Core(SQL)\\"", "  type:\\"Microsoft.DocumentDb/databaseAccounts\\"", "  ", "  -Microsoft.Search/searchServices/customdatasearch", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Search/searchServices/customdatasearch\\"", "  location:\\"westus2\\"", "  name:\\"customdatasearch\\"", "  sku.name:\\"standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Search/searchServices\\"", "  ", "  -Microsoft.Storage/storageAccounts/clitranslatorapi", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/clitranslatorapi\\"", "  kind:\\"Storage\\"", "  location:\\"westus\\"", "  name:\\"clitranslatorapi\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/customdataforgpt", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/customdataforgpt\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastus\\"", "  name:\\"customdataforgpt\\"", "  sku.name:\\"Standard_RAGRS\\"", "  sku.tier:\\"Standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/translatortempfiles", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/translatortempfiles\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastasia\\"", "  name:\\"translatortempfiles\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9\\"", "  kind:\\"functionapp\\"", "  location:\\"westus\\"", "  name:\\"ASP-clitranslatorrg-bdc9\\"", "  sku.capacity:0", "  sku.family:\\"Y\\"", "  sku.name:\\"Y1\\"", "  sku.size:\\"Y1\\"", "  sku.tier:\\"Dynamic\\"", "  type:\\"Microsoft.Web/serverFarms\\"", "  ", "  -Microsoft.Web/sites/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/sites/cli-translator\\"", "  kind:\\"functionapp,linux\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.hidden-link:/app-insights-conn-string:\\"InstrumentationKey=11b638ce-0c16-42cc-9516-58122a1922ef;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com/;LiveEndpoint=https://westus.livediagnostics.monitor.azure.com/\\"", "  tags.hidden-link:/app-insights-instrumentation-key:\\"11b638ce-0c16-42cc-9516-58122a1922ef\\"", "  tags.hidden-link:/app-insights-resource-id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  type:\\"Microsoft.Web/sites\\"", "  ", "  -microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator\\"", "  location:\\"global\\"", "  name:\\"FailureAnomalies-cli-translator\\"", "  type:\\"microsoft.alertsmanagement/smartDetectorAlertRules\\"", "  ", "  -microsoft.insights/components/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  kind:\\"web\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  type:\\"microsoft.insights/components\\"", "  ", "- +Microsoft.Compute/virtualMachines/zytest[-preview]", "?                                           --------\\n", "+ +Microsoft.Compute/virtualMachines/zytest[]", "  ", "- apiVersion:\\"-preview\\"", "?             --------\\n", "+ apiVersion:\\"\\"", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Compute/virtualMachines/zytest\\"", "  location:\\"westus\\"", "  name:\\"zytest\\"", "- properties.storageProfile.osDisk.encryptionSettings.diskEncryptionKey.secretUrl:\\"zytest\\"", "- properties.storageProfile.osDisk.encryptionSettings.diskEncryptionKey.sourceVault.id:\\"zytest\\"", "+ properties.diagnosticsProfile.bootDiagnostics.enabled:true", "+ properties.diagnosticsProfile.bootDiagnostics.storageUri:\\"http://zytest.blob.core.windows.net/\\"", "+ properties.hardwareProfile.vmSize:\\"Standard_DS1_v2\\"", "+ properties.networkProfile.networkInterfaces:[", "+ 0:", "+ ", "+ id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Network/networkInterfaces/zytest-nic\\"", "+ ", "+ ]", "+ properties.osProfile.adminPassword:\\"*******\\"", "+ properties.osProfile.adminUsername:\\"[parameters(\'adminUsername\')]\\"", "+ properties.osProfile.computerName:\\"zytest\\"", "+ properties.securityProfile.encryptionAtHost:true", "+ properties.storageProfile.imageReference.offer:\\"WindowsServer\\"", "+ properties.storageProfile.imageReference.publisher:\\"MicrosoftWindowsServer\\"", "+ properties.storageProfile.imageReference.sku:\\"2019-Datacenter\\"", "+ properties.storageProfile.imageReference.version:\\"latest\\"", "+ tags.azsecpack:\\"nonprod\\"", "  tags.platformsettings.host_environment.service.platform_optedin_for_rootcerts:\\"true\\"", "  type:\\"Microsoft.Compute/virtualMachines\\"", "  ", "+ +Microsoft.Compute/virtualMachines/zytest/extensions/AzureDiskEncryption[]", "+ ", "+ apiVersion:\\"\\"", "+ id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Compute/virtualMachines/zytest/extensions/AzureDiskEncryption\\"", "+ location:\\"westus\\"", "+ name:\\"AzureDiskEncryption\\"", "+ properties.autoUpgradeMinorVersion:true", "+ properties.protectedSettings:\\"*******\\"", "+ properties.publisher:\\"Microsoft.Azure.Security\\"", "+ properties.settings.EncryptionOperation:\\"EnableEncryption\\"", "+ properties.settings.KekVaultResourceId:\\"/subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus\\"", "+ properties.settings.KeyEncryptionKeyURL:\\"https://diskencryptiontestaus.vault.azure.net/keys/DiskEncryptionKek/562a4bb76b524a1493a6afe8e536ee78\\"", "+ properties.settings.KeyVaultResourceId:\\"/subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus\\"", "+ properties.settings.KeyVaultURL:\\"/subscriptions/9135e259-1f76-4dbd-a5c8-bc4fcdf3cf1c/resourceGroups/DiskEncryptionTest/providers/Microsoft.KeyVault/vaults/DiskEncryptionTestAus\\"", "+ properties.settings.VolumeType:\\"ALL\\"", "+ properties.type:\\"AzureDiskEncryption\\"", "+ properties.typeHandlerVersion:\\"2.2\\"", "+ type:\\"Microsoft.Compute/virtualMachines/extensions\\"", "+ ", "- Resourcechanges:10todelete,1tocreate.", "?                            ^\\n", "+ Resourcechanges:10todelete,2tocreate.", "?                            ^\\n"], "diff_summary": {"added": 40, "deleted": 5, "differential_rate": "0.388"}}