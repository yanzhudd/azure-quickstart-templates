arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"omsWorkspaceName": {"type": "string", "defaultValue": "[concat(\'oms-workspace\',uniqueString(resourceGroup().id))]"}, "omsSolutionsName": {"type": "array", "defaultValue": "zytest"}, "tags": {"type": "object", "defaultValue": "zytest"}, "sku": {"type": "string", "allowedValues": ["Free", "Standalone", "PerNode"], "defaultValue": "Free", "metadata": {"description": "Service Tier: Free, Standalone, or PerNode"}}, "dataRetention": {"type": "int", "defaultValue": 90, "minValue": 7, "maxValue": 730, "metadata": {"description": "Number of days of retention. Free plans can only have 7 days, Standalone and OMS plans include 30 days for free"}}, "location": {"type": "string", "defaultValue": "westus"}}, "resources": [{"name": "[parameters(\'omsWorkspaceName\')]", "type": "Microsoft.OperationalInsights/workspaces", "apiVersion": "2021-06-01", "location": "[parameters(\'location\')]", "tags": "[parameters(\'tags\')]", "properties": {"sku": {"name": "[parameters(\'sku\')]"}, "retention": "[parameters(\'dataRetention\')]"}}, {"type": "Microsoft.OperationsManagement/solutions", "name": "[concat(parameters(\'omsSolutionsName\')[copyIndex()], \'(\', parameters(\'omsWorkspaceName\'), \')\')]", "apiVersion": "2015-11-01-preview", "location": "[parameters(\'location\')]", "dependsOn": ["[parameters(\'omsWorkspaceName\')]"], "copy": {"name": "copy-oms-solutions", "count": "[length(parameters(\'omsSolutionsName\'))]"}, "plan": {"name": "[concat(parameters(\'omsSolutionsName\')[copyIndex()], \'(\', parameters(\'omsWorkspaceName\'), \')\')]", "product": "[concat(\'OMSGallery/\', parameters(\'omsSolutionsName\')[copyIndex()])]", "promotionCode": "", "publisher": "Microsoft"}, "properties": {"workspaceResourceId": "[resourceId(\'Microsoft.OperationalInsights/workspaces\', parameters(\'omsWorkspaceName\'))]"}}, {"type": "Microsoft.OperationalInsights/workspaces/datasources", "kind": "AzureActivityLog", "name": "[concat(parameters(\'omsWorkspaceName\'), \'/\', subscription().subscriptionId)]", "apiVersion": "2020-08-01", "location": "[parameters(\'location\')]", "dependsOn": ["[parameters(\'omsWorkspaceName\')]"], "properties": {"linkedResourceId": "[subscriptionResourceId(\'microsoft.insights/eventTypes\', \'management\')]"}}], "outputs": {"workspaceName": {"type": "string", "value": "[parameters(\'omsWorkspaceName\')]"}}}


cli_script
Based on the provided JSON data, I will translate the ARM template into an equivalent Azure CLI script. First, I\'ll extract the parameters and then translate each resource into its corresponding CLI command.\n\n```bash\n#!/bin/bash\n\n# Parameters\nomsWorkspaceName=$(echo "oms-workspace$(az group show --query id --output tsv | tr -d \'\\n\' | sha1sum | head -c 10)")\nomsSolutionsName=("zytest") # Assuming "zytest" is an example array element\ntags="zytest" # Assuming "zytest" is an example tag\nsku="Free"\ndataRetention=90\nlocation="westus"\n\n# Create the Log Analytics Workspace\naz monitor log-analytics workspace create \\\n    --resource-group <ResourceGroupName> \\\n    --workspace-name $omsWorkspaceName \\\n    --location $location \\\n    --tags $tags \\\n    --sku $sku \\\n    --retention-time $dataRetention\n\n# Create the OMS Solutions\n# Assuming the "omsSolutionsName" is an array of solution names, but since there is only one example element "zytest", we will process it directly.\nsolutionName="${omsSolutionsName[0]}"\nworkspaceResourceId=$(az monitor log-analytics workspace show --resource-group <ResourceGroupName> --workspace-name $omsWorkspaceName --query id --output tsv)\n\naz monitor log-analytics solution create \\\n    --resource-group <ResourceGroupName> \\\n    --solution-name "$solutionName($omsWorkspaceName)" \\\n    --location $location \\\n    --workspace-resource-id $workspaceResourceId \\\n    --plan-name "$solutionName($omsWorkspaceName)" \\\n    --plan-product "OMSGallery/$solutionName" \\\n    --plan-publisher "Microsoft"\n\n# Link Azure Activity Log to the Log Analytics Workspace\naz monitor log-analytics workspace data-export create \\\n    --resource-group <ResourceGroupName> \\\n    --workspace-name $omsWorkspaceName \\\n    --name $omsWorkspaceName \\\n    --data-source "/subscriptions/$(az account show --query id --output tsv)/providers/microsoft.insights/eventTypes/management"\n\n# Output the workspace name\necho "Workspace Name: $omsWorkspaceName"\n```\n\nPlease replace `<ResourceGroupName>` with your actual Azure resource group name where you want to deploy these resources.\n\nNote:\n- The ARM template uses `uniqueString(resourceGroup().id)` to generate a unique workspace name. I\'ve emulated this by hashing the resource group ID and taking the first 10 characters.\n- The `omsSolutionsName` parameter is an array, but only one example element "zytest" is provided. If you have multiple elements, you would loop through them and create a solution for each one.\n- The `tags` parameter is assumed to be a simple string "zytest", but in reality, tags should be a dictionary of key-value pairs. Adjust the `--tags` parameter accordingly.\n- The `sku`, `dataRetention`, and `location` parameters are straightforward conversions.\n- The `Microsoft.OperationsManagement/solutions` and `Microsoft.OperationalInsights/workspaces/datasources` resources are translated to their corresponding CLI commands.\n- The `outputs` section is not directly translatable to CLI, but I\'ve added an echo statement to output the workspace name.


verify_result
