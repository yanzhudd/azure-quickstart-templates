arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"existingManagedImageID": {"type": "string", "metadata": {"description": "Resource Id of the existing Managed Image"}, "defaultValue": "zytest"}, "existingGalleryName": {"type": "string", "metadata": {"description": "Name of the Azure Compute Gallery."}, "defaultValue": "zytest"}, "existingGalleryImageDefinitionName": {"type": "string", "metadata": {"description": "Name of the Image Definition."}, "defaultValue": "zytest"}, "galleryImageVersionName": {"type": "string", "metadata": {"description": "Name of the Image Version - should follow <MajorVersion>.<MinorVersion>.<Patch>."}, "defaultValue": "zytest"}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Location of the Azure Compute Gallery."}}}, "resources": [{"type": "Microsoft.Compute/galleries/images/versions", "apiVersion": "2020-09-30", "name": "[concat(parameters(\'existingGalleryName\'), \'/\', parameters(\'existingGalleryImageDefinitionName\'), \'/\', parameters(\'galleryImageVersionName\'))]", "location": "[parameters(\'location\')]", "properties": {"publishingProfile": {"replicaCount": 1, "targetRegions": [{"name": "[parameters(\'location\')]"}]}, "storageProfile": {"source": {"id": "[parameters(\'existingManagedImageID\')]"}, "osDiskImage": {"hostCaching": "ReadWrite"}}}}], "outputs": {"existingGalleryName": {"type": "string", "value": "[parameters(\'existingGalleryName\')]"}, "galleryImageVersion": {"type": "string", "value": "[parameters(\'galleryImageVersionName\')]"}, "existingGalleryImageDefinitionName": {"type": "string", "value": "[ parameters(\'existingGalleryImageDefinitionName\')]"}}}


cli_script
Based on the provided ARM template and template parameters, here is the equivalent Azure CLI script in bash:\n\n```bash\n#!/bin/bash\n\n# Parameters\nexistingManagedImageID="zytest"\nexistingGalleryName="zytest"\nexistingGalleryImageDefinitionName="zytest"\ngalleryImageVersionName="zytest"\nlocation="westus"\n\n# Create the gallery image version\naz sig image-version create \\\n  --resource-group <ResourceGroupName> \\ # Replace <ResourceGroupName> with your actual resource group name\n  --gallery-name $existingGalleryName \\\n  --gallery-image-definition $existingGalleryImageDefinitionName \\\n  --gallery-image-version $galleryImageVersionName \\\n  --location $location \\\n  --managed-image $existingManagedImageID \\\n  --replica-count 1 \\\n  --target-regions $location \\\n  --os-snapshot-lun 0 \\ # Assuming this is for an OS disk; if not, remove or modify this line\n  --host-caching ReadWrite\n\n# Output variables\necho "existingGalleryName: $existingGalleryName"\necho "galleryImageVersion: $galleryImageVersionName"\necho "existingGalleryImageDefinitionName: $existingGalleryImageDefinitionName"\n```\n\nPlease note that you need to replace `<ResourceGroupName>` with the name of the resource group where your Azure Compute Gallery is located. Also, the `--os-snapshot-lun 0` line is an assumption that this is for an OS disk; if this is not the case, you should remove or modify this line accordingly.\n\nThis script assumes that you have Azure CLI installed and configured to use your Azure subscription. Also, it assumes that you are using Managed Images and not snapshots, as indicated by the `--managed-image` flag. If you are using snapshots, you would need to adjust the script accordingly.


verify_result
{"diff_info": ["  ", "  Thedeploymentwillupdatethefollowingscope:", "  ", "  Scope:/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg", "  ", "  -Microsoft.CognitiveServices/accounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.CognitiveServices/accounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"FormRecognizer\\"", "  location:\\"westus2\\"", "  name:\\"cli-translator\\"", "  sku.name:\\"F0\\"", "  type:\\"Microsoft.CognitiveServices/accounts\\"", "  ", "  -Microsoft.DocumentDb/databaseAccounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.DocumentDb/databaseAccounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"GlobalDocumentDB\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.defaultExperience:\\"Core(SQL)\\"", "  type:\\"Microsoft.DocumentDb/databaseAccounts\\"", "  ", "  -Microsoft.Search/searchServices/customdatasearch", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Search/searchServices/customdatasearch\\"", "  location:\\"westus2\\"", "  name:\\"customdatasearch\\"", "  sku.name:\\"standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Search/searchServices\\"", "  ", "  -Microsoft.Storage/storageAccounts/clitranslatorapi", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/clitranslatorapi\\"", "  kind:\\"Storage\\"", "  location:\\"westus\\"", "  name:\\"clitranslatorapi\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/customdataforgpt", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/customdataforgpt\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastus\\"", "  name:\\"customdataforgpt\\"", "  sku.name:\\"Standard_RAGRS\\"", "  sku.tier:\\"Standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/translatortempfiles", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/translatortempfiles\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastasia\\"", "  name:\\"translatortempfiles\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9\\"", "  kind:\\"functionapp\\"", "  location:\\"westus\\"", "  name:\\"ASP-clitranslatorrg-bdc9\\"", "  sku.capacity:0", "  sku.family:\\"Y\\"", "  sku.name:\\"Y1\\"", "  sku.size:\\"Y1\\"", "  sku.tier:\\"Dynamic\\"", "  type:\\"Microsoft.Web/serverFarms\\"", "  ", "  -Microsoft.Web/sites/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/sites/cli-translator\\"", "  kind:\\"functionapp,linux\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.hidden-link:/app-insights-conn-string:\\"InstrumentationKey=11b638ce-0c16-42cc-9516-58122a1922ef;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com/;LiveEndpoint=https://westus.livediagnostics.monitor.azure.com/\\"", "  tags.hidden-link:/app-insights-instrumentation-key:\\"11b638ce-0c16-42cc-9516-58122a1922ef\\"", "  tags.hidden-link:/app-insights-resource-id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  type:\\"Microsoft.Web/sites\\"", "  ", "  -microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator\\"", "  location:\\"global\\"", "  name:\\"FailureAnomalies-cli-translator\\"", "  type:\\"microsoft.alertsmanagement/smartDetectorAlertRules\\"", "  ", "  -microsoft.insights/components/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  kind:\\"web\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  type:\\"microsoft.insights/components\\"", "  ", "  +Microsoft.Compute/galleries/zytest/images/zytest/versions/zytest[]", "  ", "  apiVersion:\\"\\"", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Compute/galleries/zytest/images/zytest/versions/zytest\\"", "  location:\\"westus\\"", "  name:\\"zytest\\"", "+ properties.publishingProfile.excludeFromLatest:false", "  properties.publishingProfile.replicaCount:1", "  properties.publishingProfile.targetRegions:[", "  0:", "  ", "  name:\\"westus\\"", "+ regionalReplicaCount:1", "+ storageAccountType:\\"Standard_LRS\\"", "  ", "  ]", "  properties.storageProfile.osDiskImage.hostCaching:\\"ReadWrite\\"", "- properties.storageProfile.source.id:\\"zytest\\"", "+ properties.storageProfile.osDiskImage.source.id:\\"zytest\\"", "?                           ++++++++++++\\n", "  type:\\"Microsoft.Compute/galleries/images/versions\\"", "  ", "  Resourcechanges:10todelete,1tocreate."], "diff_summary": {"added": 4, "deleted": 1, "differential_rate": "0.041"}}