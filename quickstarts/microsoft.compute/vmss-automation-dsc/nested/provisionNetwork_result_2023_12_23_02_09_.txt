arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"location": {"type": "string", "defaultValue": "westus"}, "virtualNetworkName": {"type": "string", "defaultValue": "zytest"}, "virtualNetworkAddressRange": {"type": "string", "defaultValue": "zytest"}, "virtualNetworkSubnets": {"type": "array", "defaultValue": "zytest"}, "publicIPAddressName": {"type": "string", "defaultValue": "zytest"}, "publicIPAddressType": {"type": "string", "defaultValue": "zytest"}, "loadBalancerName": {"type": "string", "defaultValue": "zytest"}, "httpProbeRequestPath": {"type": "string", "defaultValue": "/iisstart.htm"}}, "resources": [{"name": "[parameters(\'virtualNetworkName\')]", "type": "Microsoft.Network/virtualNetworks", "location": "[parameters(\'location\')]", "apiVersion": "2018-12-01", "properties": {"addressSpace": {"addressPrefixes": ["[parameters(\'virtualNetworkAddressRange\')]"]}, "subnets": "[parameters(\'virtualNetworkSubnets\')]"}}, {"name": "[parameters(\'publicIPAddressName\')]", "type": "Microsoft.Network/publicIPAddresses", "location": "[parameters(\'location\')]", "apiVersion": "2018-12-01", "dependsOn": ["[parameters(\'virtualNetworkName\')]"], "properties": {"publicIPAllocationMethod": "[parameters(\'publicIPAddressType\')]"}}, {"type": "Microsoft.Network/loadBalancers", "name": "[parameters(\'loadBalancerName\')]", "location": "[parameters(\'location\')]", "apiVersion": "2018-12-01", "dependsOn": ["[parameters(\'publicIPAddressName\')]"], "properties": {"frontendIPConfigurations": [{"name": "frontendIPConfiguration", "properties": {"publicIPAddress": {"id": "[resourceId(\'Microsoft.Network/publicIPAddresses\', parameters(\'publicIPAddressName\'))]"}}}], "backendAddressPools": [{"name": "backendAddressPool"}], "probes": [{"name": "httpProbe", "properties": {"protocol": "Http", "port": 80, "intervalInSeconds": 5, "numberOfProbes": 2, "requestPath": "[parameters(\'httpProbeRequestPath\')]"}}], "loadBalancingRules": [{"name": "loadBalancingRule", "properties": {"frontendIPConfiguration": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/frontendIPConfigurations\',parameters(\'loadBalancerName\'),\'frontendIPConfiguration\')]"}, "backendAddressPool": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/backendAddressPools\',parameters(\'loadBalancerName\'),\'backendAddressPool\')]"}, "protocol": "Tcp", "frontendPort": 80, "backendPort": 80, "enableFloatingIP": false, "idleTimeoutInMinutes": 5, "probe": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/probes\',parameters(\'loadBalancerName\'),\'httpProbe\')]"}}}], "inboundNatPools": [{"name": "natRDPPool", "properties": {"frontendIPConfiguration": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/frontendIPConfigurations\',parameters(\'loadBalancerName\'),\'frontendIPConfiguration\')]"}, "protocol": "Tcp", "frontendPortRangeStart": 50000, "frontendPortRangeEnd": 50119, "backendPort": 3389}}, {"name": "natWinRMPool", "properties": {"frontendIPConfiguration": {"id": "[resourceId(\'Microsoft.Network/loadBalancers/frontendIPConfigurations\',parameters(\'loadBalancerName\'),\'frontendIPConfiguration\')]"}, "protocol": "Tcp", "frontendPortRangeStart": 51000, "frontendPortRangeEnd": 51119, "backendPort": 5896}}]}}], "outputs": {}}


cli_script
Here is the equivalent CLI script:\n\n```bash\n#!/bin/bash\n\n# Define parameters\nlocation="westus"\nvirtualNetworkName="zytest"\nvirtualNetworkAddressRange="zytest"\nvirtualNetworkSubnets="zytest"\npublicIPAddressName="zytest"\npublicIPAddressType="zytest"\nloadBalancerName="zytest"\nhttpProbeRequestPath="/iisstart.htm"\n\n# Create a virtual network\naz network vnet create --name $virtualNetworkName --resource-group myResourceGroup --location $location --address-prefix $virtualNetworkAddressRange --subnet-name $virtualNetworkSubnets\n\n# Create a public IP address\naz network public-ip create --name $publicIPAddressName --resource-group myResourceGroup --location $location --allocation-method $publicIPAddressType\n\n# Create a load balancer\naz network lb create --name $loadBalancerName --resource-group myResourceGroup --location $location --frontend-ip-name frontendIPConfiguration --public-ip-address $publicIPAddressName --backend-pool-name backendAddressPool\n\n# Add a probe to the load balancer\naz network lb probe create --resource-group myResourceGroup --lb-name $loadBalancerName --name httpProbe --protocol Http --port 80 --interval 5 --threshold 2 --path $httpProbeRequestPath\n\n# Add a rule to the load balancer\naz network lb rule create --resource-group myResourceGroup --lb-name $loadBalancerName --name loadBalancingRule --protocol Tcp --frontend-port 80 --backend-port 80 --frontend-ip-name frontendIPConfiguration --backend-pool-name backendAddressPool --probe-name httpProbe\n\n# Add NAT pools to the load balancer\naz network lb inbound-nat-pool create --resource-group myResourceGroup --lb-name $loadBalancerName --name natRDPPool --protocol Tcp --frontend-port-range-start 50000 --frontend-port-range-end 50119 --backend-port 3389 --frontend-ip-name frontendIPConfiguration\naz network lb inbound-nat-pool create --resource-group myResourceGroup --lb-name $loadBalancerName --name natWinRMPool --protocol Tcp --frontend-port-range-start 51000 --frontend-port-range-end 51119 --backend-port 5896 --frontend-ip-name frontendIPConfiguration\n```\n\nPlease replace "myResourceGroup" with your actual resource group name.


verify_result
