arm_template
{"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {"vmssName": {"type": "string", "metadata": {"description": "Name of VMSS to be decrypted"}, "maxLength": 61, "defaultValue": "zytest"}, "volumeType": {"type": "string", "defaultValue": "All", "metadata": {"description": "Type of the volume OS or Data to perform encryption operation"}}, "location": {"type": "string", "defaultValue": "westus", "metadata": {"description": "Default location"}}, "forceUpdateTag": {"type": "string", "defaultValue": "[uniqueString(resourceGroup().id, deployment().name)]", "metadata": {"description": "Pass in an unique value like a GUID everytime the operation needs to be force run"}}}, "resources": [{"type": "Microsoft.Compute/virtualMachineScaleSets/extensions", "name": "[concat(parameters(\'vmssName\'),\'/\', \'AzureDiskEncryption\')]", "location": "[parameters(\'location\')]", "apiVersion": "2020-12-01", "properties": {"publisher": "Microsoft.Azure.Security", "type": "AzureDiskEncryption", "typeHandlerVersion": "2.2", "autoUpgradeMinorVersion": true, "forceUpdateTag": "[parameters(\'forceUpdateTag\')]", "settings": {"EncryptionOperation": "DisableEncryption", "VolumeType": "[parameters(\'volumeType\')]"}}}]}


cli_script
```bash\n#!/bin/bash\n\n# Define variables from the template parameters\nvmssName="zytest" # Default value provided\nvolumeType="All" # Default value provided\nlocation="westus" # Default value provided\n# forceUpdateTag needs to be a unique value, using a placeholder here, replace with actual unique value\nforceUpdateTag=$(uuidgen)\n\n# Translate ARM resource to Azure CLI command\n# Note: Azure CLI does not directly support expressions like [uniqueString(resourceGroup().id, deployment().name)],\n# so a unique value needs to be generated outside of the ARM template, e.g., using `uuidgen` as shown above.\n\n# Create or update the Azure Disk Encryption extension for a VMSS\naz vmss extension set \\\n  --resource-group <resource-group-name> \\ # Replace <resource-group-name> with your actual resource group name\n  --vmss-name $vmssName \\\n  --name "AzureDiskEncryption" \\\n  --publisher "Microsoft.Azure.Security" \\\n  --version "2.2" \\\n  --settings "{\\"EncryptionOperation\\":\\"DisableEncryption\\",\\"VolumeType\\":\\"$volumeType\\"}" \\\n  --protected-settings "{\\"forceUpdateTag\\":\\"$forceUpdateTag\\"}" \\\n  --location $location\n```\n\nPlease replace `<resource-group-name>` with your actual resource group name where the VMSS resides. Also, ensure that you have the necessary permissions to execute these commands and that the Azure CLI is installed and logged in to the correct Azure account.


verify_result
{"diff_info": ["  ", "  Thedeploymentwillupdatethefollowingscope:", "  ", "  Scope:/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg", "  ", "  -Microsoft.CognitiveServices/accounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.CognitiveServices/accounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"FormRecognizer\\"", "  location:\\"westus2\\"", "  name:\\"cli-translator\\"", "  sku.name:\\"F0\\"", "  type:\\"Microsoft.CognitiveServices/accounts\\"", "  ", "  -Microsoft.DocumentDb/databaseAccounts/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.DocumentDb/databaseAccounts/cli-translator\\"", "  identity.type:\\"None\\"", "  kind:\\"GlobalDocumentDB\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.defaultExperience:\\"Core(SQL)\\"", "  type:\\"Microsoft.DocumentDb/databaseAccounts\\"", "  ", "  -Microsoft.Search/searchServices/customdatasearch", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Search/searchServices/customdatasearch\\"", "  location:\\"westus2\\"", "  name:\\"customdatasearch\\"", "  sku.name:\\"standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Search/searchServices\\"", "  ", "  -Microsoft.Storage/storageAccounts/clitranslatorapi", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/clitranslatorapi\\"", "  kind:\\"Storage\\"", "  location:\\"westus\\"", "  name:\\"clitranslatorapi\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/customdataforgpt", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/customdataforgpt\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastus\\"", "  name:\\"customdataforgpt\\"", "  sku.name:\\"Standard_RAGRS\\"", "  sku.tier:\\"Standard\\"", "  tags.ProjectType:\\"aoai-your-data-service\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Storage/storageAccounts/translatortempfiles", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Storage/storageAccounts/translatortempfiles\\"", "  kind:\\"StorageV2\\"", "  location:\\"eastasia\\"", "  name:\\"translatortempfiles\\"", "  sku.name:\\"Standard_LRS\\"", "  sku.tier:\\"Standard\\"", "  type:\\"Microsoft.Storage/storageAccounts\\"", "  ", "  -Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/serverFarms/ASP-clitranslatorrg-bdc9\\"", "  kind:\\"functionapp\\"", "  location:\\"westus\\"", "  name:\\"ASP-clitranslatorrg-bdc9\\"", "  sku.capacity:0", "  sku.family:\\"Y\\"", "  sku.name:\\"Y1\\"", "  sku.size:\\"Y1\\"", "  sku.tier:\\"Dynamic\\"", "  type:\\"Microsoft.Web/serverFarms\\"", "  ", "  -Microsoft.Web/sites/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Web/sites/cli-translator\\"", "  kind:\\"functionapp,linux\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  tags.hidden-link:/app-insights-conn-string:\\"InstrumentationKey=11b638ce-0c16-42cc-9516-58122a1922ef;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com/;LiveEndpoint=https://westus.livediagnostics.monitor.azure.com/\\"", "  tags.hidden-link:/app-insights-instrumentation-key:\\"11b638ce-0c16-42cc-9516-58122a1922ef\\"", "  tags.hidden-link:/app-insights-resource-id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  type:\\"Microsoft.Web/sites\\"", "  ", "  -microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.alertsmanagement/smartDetectorAlertRules/FailureAnomalies-cli-translator\\"", "  location:\\"global\\"", "  name:\\"FailureAnomalies-cli-translator\\"", "  type:\\"microsoft.alertsmanagement/smartDetectorAlertRules\\"", "  ", "  -microsoft.insights/components/cli-translator", "  ", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/microsoft.insights/components/cli-translator\\"", "  kind:\\"web\\"", "  location:\\"westus\\"", "  name:\\"cli-translator\\"", "  type:\\"microsoft.insights/components\\"", "  ", "  +Microsoft.Compute/virtualMachineScaleSets/zytest/extensions/AzureDiskEncryption[]", "  ", "  apiVersion:\\"\\"", "  id:\\"/subscriptions/6b085460-5f21-477e-ba44-1035046e9101/resourceGroups/cli-translator-rg/providers/Microsoft.Compute/virtualMachineScaleSets/zytest/extensions/AzureDiskEncryption\\"", "  location:\\"westus\\"", "  name:\\"AzureDiskEncryption\\"", "  properties.autoUpgradeMinorVersion:true", "- properties.forceUpdateTag:\\"nqaflbhl46kaa\\"", "+ properties.protectedSettings:\\"*******\\"", "  properties.publisher:\\"Microsoft.Azure.Security\\"", "- properties.settings.EncryptionOperation:\\"DisableEncryption\\"", "?                                          ^^^\\n", "+ properties.settings.EncryptionOperation:\\"EnableEncryption\\"", "?                                          ^^\\n", "  properties.settings.VolumeType:\\"All\\"", "  properties.type:\\"AzureDiskEncryption\\"", "  properties.typeHandlerVersion:\\"2.2\\"", "  type:\\"Microsoft.Compute/virtualMachineScaleSets/extensions\\"", "  ", "  Resourcechanges:10todelete,1tocreate."], "diff_summary": {"added": 2, "deleted": 2, "differential_rate": "0.033"}}